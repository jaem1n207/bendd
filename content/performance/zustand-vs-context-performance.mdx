---
title: 'Zustand vs Context API: ì˜¬ë°”ë¥¸ ì„ íƒê³¼ ì‚¬ìš©ë²•'
summary: 'ìƒíƒœ ê´€ë¦¬ ë„êµ¬ì˜ ë³¸ì§ˆ ì´í•´í•˜ê¸°'
description: 'Zustandì™€ React Context APIì˜ ë³¸ì§ˆì  ì°¨ì´ì ì„ ì´í•´í•˜ê³ , ì–¸ì œ ì–´ë–¤ ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ ì•Œì•„ë´…ë‹ˆë‹¤. ì‹¤ì œ ì„±ëŠ¥ ì¸¡ì • ë°ì´í„°ì™€ í•¨ê»˜ ê° ë„êµ¬ì˜ ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²•ê³¼ ê²°í•© íŒ¨í„´ê¹Œì§€ ì™„ë²½ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.'
category: 'performance'
publishedAt: '2024-04-30'
---

## ì™œ zustandë¥¼ ì‚¬ìš©í–ˆì„ê¹Œìš”?

ReactëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ì „ì²´ì— ë°ì´í„°ë¥¼ ì œê³µí•  ìˆ˜ ìˆëŠ” `Context API`ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ APIëŠ” ì•±ì˜ í¬ê¸°ê°€ í¬ì§€ ì•Šë‹¤ë©´ ë§¤ìš° í¸í•˜ê³  ìœ ìš©í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì•±ì´ ì»¤ì§„ë‹¤ë©´ ì„±ëŠ¥ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. context ê°’ì— ë³€ê²½ ì‚¬í•­ì´ ìˆì„ ë•Œë§ˆë‹¤ useContextê°€ ë‹¤ì‹œ ë Œë”ë§í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ê±´ ê°’ì˜ ì¼ë¶€ê°€ ë Œë”ì— ì‚¬ìš©ë˜ì§€ ì•Šì•„ë„ ë°œìƒí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŠ” [ì˜ë„ëœ ê²ƒ](https://github.com/facebook/react/issues/14110)ì´ë©° ë§Œì•½ useContextê°€ ì¡°ê±´ë¶€ë¡œ ë¦¬ë Œë”ë§ì„ íŠ¸ë¦¬ê±°í•œë‹¤ë©´ ì¬ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” hookì´ ë©ë‹ˆë‹¤.

useContext í›…ì˜ ë¦¬ë Œë”ë§ì„ ë°©ì§€í•  ìˆ˜ ìˆëŠ” ì„¸ ê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.

ê°„ë‹¨í•œ ì˜ˆë¥¼ ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤. `ë°”ë¥´ì…€ë¡œë‚˜`ì™€ `ë ˆì•Œ ë§ˆë“œë¦¬ë“œ`ì˜ íŒ€ ë©¤ë²„ë¥¼ ê°€ì§„ ê°ì²´ê°€ ìˆìŠµë‹ˆë‹¤:

```tsx
const initialFirstTeamMembers = {
  barca: ['messi', 'suarez', 'neymar'],
  madrid: ['ronaldo', 'bale', 'benzema'],
};
```

useReducer í›…ì— ì „ë‹¬í•œ reducerë¥¼ ì •ì˜í•©ë‹ˆë‹¤:

```tsx title="í†µí•© reducer (ìµœì í™” ì „)"
const reducer = (
  state: typeof initialFirstTeamMembers,
  action: Action
): State => {
  switch (action.type) {
    case 'add':
      return {
        ...state,
        [action.team]: [...state[action.team], action.player], // [!code highlight]
      };
    case 'remove':
      return {
        ...state,
        [action.team]: state[action.team].filter( // [!code highlight]
          player => player !== action.player
        ),
      };
    default:
      return state;
  }
};
```

Context ProviderëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

```tsx title="ë‹¨ì¼ Context Provider (ìµœì í™” ì „)"
const FirstTeamMembersContext = createContext(undefined);

const useFirstTeamMembers = () => {
  const context = useContext(FirstTeamMembersContext);

  if (context === undefined) {
    throw new Error(
      'useFirstTeamMembers must be used within a FirstTeamMembersProvider'
    );
  }

  return context;
};

const FirstTeamMembersProvider = ({ children }) => {
  const [state, dispatch] = useReducer(reducer, initialState);
  return (
    <FirstTeamMembersContext.Provider value={value}> {/* [!code highlight] */}
      <Barca />
      <Madrid />
    </FirstTeamMembersContext.Provider>
  );
};
```

`Barca` ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„ë©ë‹ˆë‹¤:

```tsx title="Barca ì»´í¬ë„ŒíŠ¸ (ìµœì í™” ì „)"
export const Barca = () => {
  const [state, dispatch] = useFirstTeamMembers(); // [!code highlight]

  return (
    <>
      <h3>Barcelona</h3>
      <ul>
        {state.barca.map(player => (
          <li key={player}>
            {player}
            <button
              onClick={() =>
                dispatch({ type: 'remove', team: 'barca', player }) // [!code highlight]
              }
            >
              Remove
            </button>
          </li>
        ))}
      </ul>
    </>
  );
};
```

`Madrid` ì»´í¬ë„ŒíŠ¸ë„ ì´ì™€ ìœ ì‚¬í•©ë‹ˆë‹¤.

`madrid`ì˜ ë©¤ë²„ê°€ ë³€ê²½ë˜ë©´ `Barca`ë„ ë¦¬ë Œë”ë§ë˜ì–´ ì´ì „ê³¼ ë™ì¼í•œ ì¶œë ¥ì´ ìƒì„±ë©ë‹ˆë‹¤. ë§Œì•½ ë¦¬ë Œë”ë§í•  ì»´í¬ë„ŒíŠ¸ê°€ ë§ì„ ê²½ìš° ì†ë„ê°€ ëŠë ¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì œëŠ” [gaearonì´ ì œì‹œ](https://github.com/facebook/react/issues/15156#issuecomment-474590693)í•œ ê²ƒì²˜ëŸ¼ ë‹¤ìŒ ì„¸ ê°€ì§€ ë°©ë²•ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Context API ìµœì í™” ë°©ë²•

### 1. ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¶„í• í•©ë‹ˆë‹¤

ê°€ì¥ ê¶Œì¥ë˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ìœ„ ì˜ˆì œë¥¼ ì•„ë˜ì²˜ëŸ¼ ë¶„í• í•©ë‹ˆë‹¤:

```tsx
const initialBarcaState: { barca: Members } = {
  barca: ['messi', 'suarez', 'neymar'],
};

const initialMadridState: { madrid: Members } = {
  madrid: ['ronaldo', 'bale', 'modric'],
};
```

ê·¸ë¦¬ê³  ë‘ ê°œì˜ reducerì™€ contextë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½í•©ë‹ˆë‹¤:

<MagicMove
  lang="typescript"
  codeSnippets={[
    {
      title: "1ë‹¨ê³„: ê¸°ë³¸ íƒ€ì…ê³¼ Context ì •ì˜",
      description: "ë¶„í• ëœ Contextë¥¼ ìœ„í•œ ê¸°ë³¸ íƒ€ì…ë“¤ì„ ì •ì˜í•©ë‹ˆë‹¤",
      content: `import {
  createContext,
  Dispatch,
  useContext,
  useReducer,
  type ReactNode,
} from 'react';

type Action =
  | { type: 'add'; player: string }
  | { type: 'remove'; player: string };

type Members = string[];

// ê° íŒ€ë³„ë¡œ ë…ë¦½ì ì¸ Context ìƒì„±
const BarcaTeamMembersContext = createContext<
  [Members, Dispatch<Action>] | undefined
>(undefined);

const MadridTeamMembersContext = createContext<
  [Members, Dispatch<Action>] | undefined
>(undefined);`
    },
    {
      title: "2ë‹¨ê³„: ë…ë¦½ì ì¸ ì´ˆê¸° ìƒíƒœ ì •ì˜",
      description: "ê° íŒ€ë³„ë¡œ ë¶„ë¦¬ëœ ì´ˆê¸° ìƒíƒœë¥¼ ì •ì˜í•©ë‹ˆë‹¤",
      content: `// ì´ì „: í•˜ë‚˜ì˜ í†µí•© ìƒíƒœ
// const initialFirstTeamMembers = {
//   barca: ['messi', 'suarez', 'neymar'],
//   madrid: ['ronaldo', 'bale', 'modric'],
// };

// ì´í›„: íŒ€ë³„ë¡œ ë¶„ë¦¬ëœ ìƒíƒœ
const initialBarcaState: { barca: Members } = {
  barca: ['messi', 'suarez', 'neymar'],
};

const initialMadridState: { madrid: Members } = {
  madrid: ['ronaldo', 'bale', 'modric'],
};`
    },
    {
      title: "3ë‹¨ê³„: íŒ€ë³„ ë…ë¦½ Reducer êµ¬í˜„",
      description: "ê° íŒ€ë§Œì˜ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ë…ë¦½ì ì¸ reducerë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤",
      content: `const barcaReducer = (state: typeof initialBarcaState, action: Action) => {
  switch (action.type) {
    case 'add':
      return { barca: [...state.barca, action.player] };
    case 'remove':
      return {
        barca: state.barca.filter(player => player !== action.player),
      };
    default:
      return state;
  }
};

const madridReducer = (state: typeof initialMadridState, action: Action) => {
  switch (action.type) {
    case 'add':
      return { madrid: [...state.madrid, action.player] };
    case 'remove':
      return {
        madrid: state.madrid.filter(player => player !== action.player),
      };
    default:
      return state;
  }
};`
    },
    {
      title: "4ë‹¨ê³„: ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ì•ˆì „í•œ ì ‘ê·¼",
      description: "íƒ€ì… ì•ˆì „ì„±ê³¼ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í¬í•¨í•œ ì»¤ìŠ¤í…€ í›…ì„ êµ¬í˜„í•©ë‹ˆë‹¤",
      content: `export const useBarcaTeamMembers = () => {
  const context = useContext(BarcaTeamMembersContext);
  if (!context) {
    throw new Error(
      'useBarcaTeamMembers must be used within a BarcaTeamMembersProvider'
    );
  }
  return context;
};

export const useMadridTeamMembers = () => {
  const context = useContext(MadridTeamMembersContext);
  if (!context) {
    throw new Error(
      'useMadridTeamMembers must be used within a MadridTeamMembersProvider'
    );
  }
  return context;
};`
    },
    {
      title: "5ë‹¨ê³„: ë…ë¦½ì ì¸ Provider ì»´í¬ë„ŒíŠ¸",
      description: "ê° íŒ€ë³„ë¡œ ë…ë¦½ì ì¸ Providerë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤",
      content: `export const BarcaTeamMembersProvider = ({
  children,
}: {
  children: ReactNode;
}) => {
  const [state, dispatch] = useReducer(barcaReducer, initialBarcaState);

  return (
    <BarcaTeamMembersContext.Provider value={[state.barca, dispatch]}>
      {children}
    </BarcaTeamMembersContext.Provider>
  );
};

export const MadridTeamMembersProvider = ({
  children,
}: {
  children: ReactNode;
}) => {
  const [state, dispatch] = useReducer(madridReducer, initialMadridState);

  return (
    <MadridTeamMembersContext.Provider value={[state.madrid, dispatch]}>
      {children}
    </MadridTeamMembersContext.Provider>
  );
};`
    },
    {
      title: "6ë‹¨ê³„: í†µí•© Providerë¡œ ì¡°í•©",
      description: "ê°œë³„ Providerë“¤ì„ ì¡°í•©í•˜ì—¬ í•˜ë‚˜ì˜ í†µí•© Providerë¥¼ ë§Œë“­ë‹ˆë‹¤",
      content: `export const FirstTeamMembersProvider = ({
  children,
}: {
  children: ReactNode;
}) => {
  return (
    <BarcaTeamMembersProvider>
      <MadridTeamMembersProvider>
        {children}
      </MadridTeamMembersProvider>
    </BarcaTeamMembersProvider>
  );
};

// ì´ì œ ê° íŒ€ì˜ ìƒíƒœê°€ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ë˜ì–´
// Barca ìƒíƒœ ë³€ê²½ ì‹œ Madrid ì»´í¬ë„ŒíŠ¸ëŠ” ë¦¬ë Œë”ë§ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤!`
    }
  ]}
/>

`Barca` ì»´í¬ë„ŒíŠ¸ë¥¼ ìˆ˜ì •í•˜ê² ìŠµë‹ˆë‹¤:

```tsx title="Barca ì»´í¬ë„ŒíŠ¸ (ìµœì í™” í›„)"
import { useBarcaTeamMembers } from './TeamProvider';

export const Barca = () => {
  const [state, dispatch] = useBarcaTeamMembers(); // [!code highlight]

  return (
    <>
      <h3>Barcelona</h3>
      <ul>
        {state.map(player => ( // [!code highlight]
          <li key={player}>
            {player}
            <button onClick={() => dispatch({ type: 'remove', player })}> {/* [!code highlight] */}
              Remove
            </button>
          </li>
        ))}
      </ul>
    </>
  );
};
```

`Madrid` ì»´í¬ë„ŒíŠ¸ë„ ìœ ì‚¬í•˜ê²Œ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤. ì´ì œ Barca ë©¤ë²„ë¥¼ ë³€ê²½í•˜ë©´ `Barca` ì»´í¬ë„ŒíŠ¸ë§Œ ë¦¬ë Œë”ë§ë©ë‹ˆë‹¤(ì•„ë˜ì—ì„œ ìµœì í™” ì „/í›„ì— ëŒ€í•œ ì„±ëŠ¥ ë¹„êµë¥¼ ë‹¤ë£¹ë‹ˆë‹¤). ê·¸ëŸ¬ë‚˜ ë‹¨ì¼ ìƒíƒœë¡œ ìœ ì§€í•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” ì´ ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### 2. React.memoì™€ ì»´í¬ë„ŒíŠ¸ ë¶„í• 

ë‘ ë²ˆì¬ ë°©ë²•ì€ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‘˜ë¡œ ë‚˜ëˆ„ê³  ê·¸ ì‚¬ì´ì— `React.memo`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ ë°©ë²•ë„ ê´€ìš©ì ìœ¼ë¡œ ì‚¬ìš©ë˜ë©° ì²˜ìŒ ì˜ˆì œì—ì„œ Contextë¥¼ ë³€ê²½í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ì—¬ì „íˆ ì™¸ë¶€ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¦¬ë Œë”ë§í•˜ì§€ë§Œ ë³µì¡í•œ ë¡œì§ì€ React.memoë¥¼ ì‚¬ìš©í•œ ë‚´ë¶€ ì»´í¬ë„ŒíŠ¸ì— ìˆìœ¼ë¯€ë¡œ ì„±ëŠ¥ìƒ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

### 3. useMemoë¡œ ìµœì í™”

ì„¸ ë²ˆì§¸ ë°©ë²•ì€ `useMemo` í›…ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ê³  ì¢…ì†ì„±ì„ ì§€ì •í•´ ë‹¨ì¼ ì»´í¬ë„ŒíŠ¸ë¡œ ìœ ì§€í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì»´í¬ë„ŒíŠ¸ëŠ” ì—¬ì „íˆ ë¦¬ë Œë”ë˜ì§€ë§Œ ì¢…ì†ì„±ìœ¼ë¡œ ì§€ì •í•œ ê°’ì´ ë™ì¼í•˜ë‹¤ë©´ ìì‹ ì»´í¬ë„ŒíŠ¸ëŠ” ë¦¬ë Œë”ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ ë°©ë²•ì—” í›…ì„ ì“¸ ìˆ˜ ì—†ë‹¤ëŠ” ì œí•œ ì‚¬í•­ì´ ì¡´ì¬í•˜ë¯€ë¡œ ë˜ë„ë¡ ê¶Œì¥í•˜ì§„ ì•ŠìŠµë‹ˆë‹¤.

ìì„¸íˆ ì•Œê³  ì‹¶ë‹¤ë©´ [Preventing rerenders with React.memo and useContext hook.](https://github.com/facebook/react/issues/15156#issuecomment-474590693) í† ë¡ ì—ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.

## ì„±ëŠ¥ ì¸¡ì • ë¹„êµ

ì´ì œ ìµœì í™” ì „/í›„ ë Œë”ë§ ì„±ëŠ¥ì„ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤. ì„±ëŠ¥ ë¹„êµëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì§„í–‰í–ˆìŠµë‹ˆë‹¤:

- ë¹„êµ ëŒ€ìƒì€ ì²˜ìŒ ì˜ˆì œì™€ Contextë¥¼ ë¶„í• í•œ ì˜ˆì œì…ë‹ˆë‹¤.
- ë Œë”ë§ ì„±ëŠ¥ ë¹„êµë¥¼ ìœ„í•´ `Barca`ì™€ `Madrid` ì»´í¬ë„ŒíŠ¸ëŠ” 15,000ê°œì˜ ë¹ˆ div ì»´í¬ë„ŒíŠ¸ë¥¼ ìì‹ìœ¼ë¡œ ë Œë”ë§í•©ë‹ˆë‹¤.
- m1 Pro ë§¥ë¶, í¬ë¡¬ ë¸Œë¼ìš°ì €, ì‹œí¬ë¦¿ ëª¨ë“œì—ì„œ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

ìœ„ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì´ í‘œì‹œë©ë‹ˆë‹¤.

![ë°”ë¥´ì…€ë¡œë‚˜ì™€ ë ˆì•Œ ë§ˆë“œë¦¬ë“œ íŒ€ ë©¤ë²„ ëª©ë¡ì„ ë³´ì—¬ì£¼ëŠ” ë Œë”ë§ í™”ë©´ ìŠ¤í¬ë¦°ìƒ·](/images/perfect-dark-mode/render-view.webp)

messi(barca) > suarez(barca) > ronaldo(madrid) > neymar(barca) ìˆœì„œëŒ€ë¡œ `dispatch` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  FlameGraphì— ì „ë‹¬í•´ ì„±ëŠ¥ì„ ì¸¡ì •í•©ë‹ˆë‹¤(react-developer-tools í™•ì¥ í”„ë¡œê·¸ë¨ì„ ì´ìš©í–ˆìŠµë‹ˆë‹¤).

### Context API ê¸°ë³¸ ì„±ëŠ¥

ì²˜ìŒ ì˜ˆì œì˜ FlameGraphë¶€í„° ë³´ê² ìŠµë‹ˆë‹¤.

![Context API ì‚¬ìš© ì‹œ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì´ ë°œìƒí•˜ëŠ” ê²ƒì„ ë³´ì—¬ì£¼ëŠ” FlameGraph gif, 92.5msì˜ ë Œë”ë§ ì‹œê°„ ê¸°ë¡](/images/perfect-dark-mode/trigger-render-context-flame.gif)

ìœ„ì˜ ê·¸ë˜í”„ ì°¨íŠ¸ë¥¼ ë³´ë©´ messi(barca) ë©¤ë²„ë¥¼ ì œê±°í•˜ë©´ `Madrid` ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ì‹œ ë Œë”ë§ ë˜ì§€ ì•Šê¸¸ ì›í•˜ì§€ë§Œ `Barca`ì™€ `Madrid` ì»´í¬ë„ŒíŠ¸ ëª¨ë‘ ë¦¬ë Œë”ë§ë˜ì—ˆìŠµë‹ˆë‹¤. ë Œë”ë§ì— ì†Œìš”ëœ ì‹œê°„ì€ **92.5ms**ì…ë‹ˆë‹¤. ë§Œì•½ ë³µì¡í•œ ë¡œì§ì„ ì²˜ë¦¬í•œë‹¤ë©´ ë Œë”ë§ ì†ë„ê°€ í›¨ì”¬ ëŠë ¤ì§ˆ ê²ƒì…ë‹ˆë‹¤. Context APIê°€ ì•±ì´ ì»¤ì§€ë©´ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì´ìœ ì…ë‹ˆë‹¤.

### Context ë¶„í•  ìµœì í™” ì„±ëŠ¥

ì´ì œ ì²« ë²ˆì§¸ ë°©ë²•ìœ¼ë¡œ ìµœì í™”í•œ ì˜ˆì œì˜ FlameGraphë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.

![Contextë¥¼ ë¶„í• í•œ í›„ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ë§Œ ë¦¬ë Œë”ë§ë˜ëŠ” ê²ƒì„ ë³´ì—¬ì£¼ëŠ” FlameGraph gif, 41.6msë¡œ 55% ì„±ëŠ¥ ê°œì„ ](/images/perfect-dark-mode/split-context-flame.gif)

ìµœì í™” í›„ì˜ ì°¨íŠ¸ë¥¼ ë³´ë©´ ë¦¬ë Œë”ë§ì´ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ë§Œ ë Œë”ë§ íì— ë“¤ì–´ê°€ ì‹¤í–‰ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë Œë”ë§ì— ì†Œìš”ëœ ì‹œê°„ë„ **41.6ms**ë¡œ ìµœì í™” ì „ì— ë¹„í•˜ë©´ ì•½ **55% ë¹¨ë¼ì¡ŒìŠµë‹ˆë‹¤**.

í•˜ì§€ë§Œ Context APIëŠ” ìœ„ ì²« ë²ˆì§¸ ìµœì í™” ì˜ˆì œ ì½”ë“œì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ ì„±ëŠ¥ ì‘ì„±í•  ì½”ë“œê°€ ì ì§€ ì•ŠìŠµë‹ˆë‹¤. Contextë¥¼ ì´ìš©í•´ ì‘ì—…í•˜ë‹¤ ì•±ì´ ì»¤ì§€ë©´ `Provider` ê°„ì˜ ì•”ì‹œì ì¸ ì¢…ì†ì„±ë„ ìƒê¸¸ ìˆ˜ ìˆê³ , ìŠ¤í† ë¦¬ë¶ ë° ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì— ëŒ€í•´ì„œë„ Context Provider ì¢…ì†ì„±ì´ ë°œìƒí•©ë‹ˆë‹¤. ì´ëŠ” ê°œë°œì ê²½í—˜ì— ì¢‹ì§€ ì•Šì£ .

## Zustandì™€ Context API: ì–¸ì œ, ì™œ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?

ì‚¬ì‹¤ zustandì™€ Context APIëŠ” **ë‹¤ë¥¸ ëª©ì **ì„ ê°€ì§„ ë„êµ¬ì˜ˆìš”. ë‹¨ìˆœíˆ 'ì „ì—­ ìƒíƒœ ê´€ë¦¬'ë¼ëŠ” ë§ë¡œ ë¬¶ì–´ì„œ ë¹„êµí•˜ê¸°ì—ëŠ” ê°ê°ì˜ ë³¸ì§ˆì´ ë‹¤ë¥´ê±°ë“ ìš”.

### Context APIì˜ ì§„ì •í•œ ì—­í• 

Context APIëŠ” ì‚¬ì‹¤ **ìƒíƒœ ê´€ë¦¬ ë„êµ¬ê°€ ì•„ë‹ˆì—ìš”**. ë” ì •í™•íˆëŠ” **ì˜ì¡´ì„± ì£¼ì…(Dependency Injection)** ë„êµ¬ì£ .

```tsx title="Context APIì˜ ë³¸ë˜ ëª©ì "
// âŒ ì´ë ‡ê²Œ ì‚¬ìš©í•˜ë©´ ì„±ëŠ¥ ë¬¸ì œ ë°œìƒ
const GlobalStateContext = createContext({ 
  user: null, 
  theme: 'light', 
  notifications: [] // [!code error]
});

// âœ… ì´ë ‡ê²Œ ì‚¬ìš©í•˜ëŠ” ê²Œ ë§ì•„ìš”
const ThemeContext = createContext('light'); // [!code highlight]
const UserServiceContext = createContext(userService); // [!code highlight]
```

[React íŒ€ë„ Context APIë¥¼ ë³µí•© ì»´í¬ë„ŒíŠ¸ ê°„ì˜ ì˜ì¡´ì„± ê´€ë¦¬ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ë¼ê³  ê¶Œì¥](https://twitter.com/sebmarkbage/status/1219836431972978689)í•´ìš” (ì˜ˆ: List > ListItem ê´€ê³„).

### Zustandì˜ ì „ì—­ ìƒíƒœ ë¬¸ì œì 

zustandëŠ” ê°•ë ¥í•˜ì§€ë§Œ, **ê¸€ë¡œë²Œ ì‹±ê¸€í†¤**ì´ë¼ëŠ” í•œê³„ê°€ ìˆì–´ìš”:

```tsx title="zustandì˜ í•œê³„ì ë“¤"
// ë¬¸ì œ 1: propsë¡œ ì´ˆê¸°í™”ê°€ ì–´ë ¤ì›€
const useCounterStore = create(() => ({
  count: 0, // ì´ ê°’ì„ propsë¡œ ë°›ìœ¼ë ¤ë©´? // [!code error]
}));

// ë¬¸ì œ 2: í…ŒìŠ¤íŠ¸ ê²©ë¦¬ê°€ ì–´ë ¤ì›€  
// ê° í…ŒìŠ¤íŠ¸ë§ˆë‹¤ ë…ë¦½ì ì¸ store ì¸ìŠ¤í„´ìŠ¤ê°€ í•„ìš”í•œë°... // [!code error]

// ë¬¸ì œ 3: ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš©ì„± ì €í•˜
// ê°™ì€ ì»´í¬ë„ŒíŠ¸ë¥¼ ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•  ë•Œ ê°ê° ë‹¤ë¥¸ ìƒíƒœë¥¼ ê°€ì ¸ì•¼ í•œë‹¤ë©´? // [!code error]
```

### ë‘ ê¸°ìˆ ì˜ ê²°í•©: ìµœê³ ì˜ í•´ê²°ì±…

[TkDodoì˜ ì ‘ê·¼ë²•](https://tkdodo.eu/blog/zustand-and-react-context)ì„ ë”°ë¼ **zustand storeë¥¼ Contextë¡œ ì œê³µ**í•˜ëŠ” ë°©ì‹ì´ ìµœì ì´ì—ìš”:

```tsx title="zustand + Context ê²°í•© íŒ¨í„´"
// 1. zustand store íŒ©í† ë¦¬ í•¨ìˆ˜ ìƒì„±
const createThemeStore = (initialTheme: Theme) => 
  create<ThemeState>()((set) => ({
    theme: initialTheme, // propsë¡œ ì´ˆê¸°í™” ê°€ëŠ¥! // [!code highlight]
    toggleTheme: () => set(state => ({ 
      theme: state.theme === 'dark' ? 'light' : 'dark' 
    })),
  }));

// 2. Contextë¡œ store ì¸ìŠ¤í„´ìŠ¤ ì œê³µ
const ThemeStoreContext = createContext<ReturnType<typeof createThemeStore> | null>(null);

export const ThemeProvider = ({ children, initialTheme = 'system' }) => {
  const store = useMemo(() => createThemeStore(initialTheme), [initialTheme]); // [!code highlight]
  
  return (
    <ThemeStoreContext.Provider value={store}>
      {children}
    </ThemeStoreContext.Provider>
  );
};

// 3. ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì ‘ê·¼
export const useThemeStore = () => {
  const store = useContext(ThemeStoreContext);
  if (!store) throw new Error('ThemeProviderê°€ í•„ìš”í•©ë‹ˆë‹¤'); // [!code highlight]
  return store;
};
```

### ì–¸ì œ ì–´ë–¤ ê±¸ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?

| ìƒí™© | ê¶Œì¥ ë„êµ¬ | ì´ìœ  |
|------|----------|------|
| **ì§„ì§œ ì „ì—­ ìƒíƒœ** (ì‚¬ìš©ì ì •ë³´, í…Œë§ˆ) | zustand ë‹¨ë… | ëª¨ë“  ê³³ì—ì„œ ì ‘ê·¼ í•„ìš” |
| **ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ìƒíƒœ** (í¼, ëª¨ë‹¬) | zustand + Context | props ì´ˆê¸°í™”, ì¬ì‚¬ìš©ì„± |
| **ì˜ì¡´ì„± ì£¼ì…** (ì„œë¹„ìŠ¤, ì„¤ì •) | Context API | ë³¸ë˜ ëª©ì ì— ë§ìŒ |
| **ë‹¨ìˆœí•œ ê°’ ì „ë‹¬** (í…Œë§ˆ ë¬¸ìì—´) | Context API | ê°„ë‹¨í•˜ê³  ì¶©ë¶„í•¨ |

`zustand`ë¥¼ ì‚¬ìš©í•˜ë©´ ë¦¬ë Œë”ë§ ë¬¸ì œë¥¼ ëª‡ ì¤„ ì•ˆ ë˜ëŠ” ì½”ë“œë¡œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ìƒí™©ì— ë§ëŠ” ì˜¬ë°”ë¥¸ ì„ íƒì´ ë” ì¤‘ìš”í•´ìš”.

```tsx title="zustandë¡œ ê°„ë‹¨í•˜ê²Œ í•´ê²°"
export const useBarcaTeamStore = create<BarcaState>(set => ({
  barca: ['messi', 'suarez', 'neymar'],
  addPlayer: player => set(state => ({ barca: [...state.barca, player] })), // [!code highlight]
  removePlayer: player =>
    set(state => ({ barca: state.barca.filter(p => p !== player) })), // [!code highlight]
}));

export const useMadridTeamStore = create<MadridState>(set => ({
  madrid: ['ronaldo', 'bale', 'modric'],
  addPlayer: player => set(state => ({ madrid: [...state.madrid, player] })), // [!code highlight]
  removePlayer: player =>
    set(state => ({ madrid: state.madrid.filter(p => p !== player) })), // [!code highlight]
}));
```

Providerë¡œ ê°ìŒ€ í•„ìš”ë„ ì—†ìŠµë‹ˆë‹¤. ë‹¨ìˆœíˆ storeë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ ìƒíƒœì˜ ì´ˆê¸°ê°’ê³¼ ì´ë¥¼ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ë©´ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  `Barca` ì»´í¬ë„ŒíŠ¸ë¥¼ ì•„ë˜ì²˜ëŸ¼ ìˆ˜ì •í•´ì¤ë‹ˆë‹¤:

```tsx title="zustand ì‚¬ìš© Barca ì»´í¬ë„ŒíŠ¸"
export const Barca = () => {
  const { barca, removePlayer } = useBarcaTeamStore(); // [!code highlight]

  return (
    <>
      <h3>Barcelona</h3>
      <ul>
        {barca.map(player => (
          <li key={player}>
            {player}
            <button onClick={() => removePlayer(player)}>Remove</button> {/* [!code highlight] */}
          </li>
        ))}
      </ul>
    </>
  );
};
```

`Madrid` ì»´í¬ë„ŒíŠ¸ë„ ìœ ì‚¬í•˜ê²Œ ìˆ˜ì •í•©ë‹ˆë‹¤. ì´ì œ FlameGraphë¥¼ ë³´ê² ìŠµë‹ˆë‹¤:

![zustand ì‚¬ìš© ì‹œ íš¨ìœ¨ì ì¸ ë¦¬ë Œë”ë§ì„ ë³´ì—¬ì£¼ëŠ” FlameGraph gif, í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ë§Œ ì—…ë°ì´íŠ¸ë¨](/images/perfect-dark-mode/zustand-flame.gif)

ë¦¬ë Œë”ë§ì´ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ë§Œ ë Œë”ë§ íì— ë“¤ì–´ê°€ ì‹¤í–‰ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì‹¤ì „ ì ìš©: ìš°ë¦¬ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì™œ zustandë¥¼?

ë‹¤í¬ ëª¨ë“œ êµ¬í˜„ì—ì„œ zustandë¥¼ ì„ íƒí•œ ì´ìœ ë¥¼ ë‹¤ì‹œ ì •ë¦¬í•´ë³´ë©´:

### 1. ì „ì—­ ìƒíƒœê°€ í•„ìš”í–ˆê¸° ë•Œë¬¸

í…Œë§ˆ ì„¤ì •ì€ **ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì—ì„œ ì ‘ê·¼**í•´ì•¼ í•˜ëŠ” ì§„ì§œ ì „ì—­ ìƒíƒœì˜ˆìš”. í—¤ë”, ì‚¬ì´ë“œë°”, ë³¸ë¬¸, í‘¸í„°ê¹Œì§€ ëª¨ë“  ê³³ì—ì„œ í…Œë§ˆ ì •ë³´ê°€ í•„ìš”í•˜ì£ .

### 2. ê°„ë‹¨í•œ APIì™€ ë›°ì–´ë‚œ ì„±ëŠ¥

```tsx title="zustandë¡œ ê°„ë‹¨í•˜ê²Œ í•´ê²°"
// Context API ë¶„í• : 50+ ì¤„ì˜ ë³µì¡í•œ ì½”ë“œ
// zustand: 10ì¤„ë¡œ í•´ê²°
const useThemeStore = create<ThemeState>()(
  persist( // [!code highlight]
    (set, get) => ({
      theme: 'system',
      toggleTheme: () => {
        const { theme, isSystemDark } = get();
        set({ theme: theme === 'system' ? (isSystemDark ? 'light' : 'dark') : 'system' }); // [!code highlight]
      },
    }),
    { name: 'theme' } // [!code highlight]
  )
);
```

### 3. localStorage í†µí•©ì˜ ìš©ì´í•¨

`persist` ë¯¸ë“¤ì›¨ì–´ë¡œ localStorage ì—°ë™ì´ í•œ ì¤„ì´ë©´ ëì´ì—ìš”. Context APIë¡œëŠ” ì´ëŸ° í¸ì˜ì„±ì„ ì–»ê¸° ì–´ë µì£ .

### ì–¸ì œ ë‹¤ë¥¸ ì„ íƒì„ í•´ì•¼ í• ê¹Œ?

í•˜ì§€ë§Œ ëª¨ë“  ìƒí™©ì—ì„œ zustandê°€ ì •ë‹µì€ ì•„ë‹ˆì—ìš”:

- **í…ŒìŠ¤íŠ¸ ê²©ë¦¬ê°€ ì¤‘ìš”í•œ í”„ë¡œì íŠ¸**: zustand + Context íŒ¨í„´
- **ì»´í¬ë„ŒíŠ¸ë³„ ë…ë¦½ì ì¸ ìƒíƒœ**: ë¡œì»¬ stateë‚˜ zustand + Context 
- **ë‹¨ìˆœí•œ prop drilling í•´ê²°**: Context APIë§Œìœ¼ë¡œ ì¶©ë¶„

## ê²°ë¡ 

ì´ì²˜ëŸ¼ zustandì™€ Context APIëŠ” ê°ìì˜ ì˜ì—­ì´ ìˆì–´ìš”. ìš°ë¦¬ ë‹¤í¬ ëª¨ë“œ í”„ë¡œì íŠ¸ì—ì„œëŠ” **ì „ì—­ ìƒíƒœ + ê°„ë‹¨í•œ API + localStorage í†µí•©**ì´ í•„ìš”í–ˆê¸° ë•Œë¬¸ì— zustandê°€ ìµœì ì˜ ì„ íƒì´ì—ˆìŠµë‹ˆë‹¤.

<Callout type="info" emoji="ğŸ’¡">
**í•µì‹¬ì€ ë„êµ¬ì˜ ë³¸ì§ˆì„ ì´í•´í•˜ëŠ” ê²ƒ**: Context APIëŠ” ì˜ì¡´ì„± ì£¼ì… ë„êµ¬, zustandëŠ” ìƒíƒœ ê´€ë¦¬ ë„êµ¬. ëª©ì ì— ë§ëŠ” ë„êµ¬ë¥¼ ì„ íƒí•˜ê³ , í•„ìš”í•˜ë‹¤ë©´ ë‘˜ì„ ê²°í•©í•´ì„œ ì‚¬ìš©í•˜ì„¸ìš”!
</Callout>

## ì„±ëŠ¥ ìš”ì•½

| êµ¬í˜„ ë°©ë²• | ë Œë”ë§ ì‹œê°„ | ì„±ëŠ¥ ê°œì„  | ì½”ë“œ ë³µì¡ë„ |
|----------|------------|----------|------------|
| Context API (ê¸°ë³¸) | 92.5ms | - | ë³´í†µ |
| Context ë¶„í•  | 41.6ms | 55% ê°œì„  | ë†’ìŒ |
| Zustand | ìœ ì‚¬í•œ ì„±ëŠ¥ | 55% ê°œì„  | ë‚®ìŒ |

## ì°¸ê³  ìë£Œ

- [Preventing rerenders with React.memo and useContext hook](https://github.com/facebook/react/issues/15156#issuecomment-474590693)
- [React Context API ì„±ëŠ¥ ìµœì í™”](https://github.com/facebook/react/issues/14110)
- [Zustand and React Context - TkDodo](https://tkdodo.eu/blog/zustand-and-react-context) - zustandì™€ Contextì˜ ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²•
- [Zustand ê³µì‹ ë¬¸ì„œ](https://docs.pmnd.rs/zustand)
- [React Context API ê³µì‹ ë¬¸ì„œ](https://react.dev/reference/react/createContext)
